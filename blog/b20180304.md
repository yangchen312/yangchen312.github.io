# Dual Booting Windows 10 and Ubuntu
## 概念
需了解双系统、系统引导、分区这三个概念。
- 双系统：
开机之后，会引导你区选择要启动的系统（grub）。
- 系统引导：
安装多个系统之后，开始顺序是这样的：开机后，先启动主系统，主系统引导出可选择的系统，然后就选择进入某一个系统。如果主系统进不去的话，所有系统都无法开启。若主系统是ubuntu，卸载ubuntu时得慎重！
一般情况下，都希望windows系统作为主系统，作为默认进入的系统。当不需要ubuntu系统的时候，可以直接在windows磁盘管理中将器所在所有分区删除，然后将EasyBCD中对应的条目删除即可。若你不小心把Ubuntu作为主系统，想恢复Windows系统为主系统也是可以的。
怎样才能让一个系统成为主系统？这跟Ubuntu系统的启动区有密切的关系。
- 分区：
Ubuntu系统的分区主要有以下4种类型：
  1. 系统区：分区类型：主分区；大小：40%的空间；用于：EXT4日志文件；挂载点：`/`;
  2. 内存区：分区类型：逻辑分区；大小：2倍内存大小；用于：交换空间；挂载点：`/swap`；
  3. 启动区：分区类型：逻辑分区；大小：200M；用于：EXT4日志文件；挂载点:`/boot`；
  4. 文件区：分区类型：逻辑分区；大小：剩余空间；用于：EXT4日志文件；挂载点：`/home`。
主分区和逻辑分区：
一块硬盘最多有四个主分区，所以为了避免出现主分区已满的情况，一般只把系统盘作为主分区，其他都作为扩展分区。

## 工具
Ubuntu系统的ISO文件
UltraISO：将系统镜像刻入U盘的工具。
Easy BCD：设置系统引导和展示可选启动系统的工具。
U盘：最好为空盘，写入过程会将U盘原有内容覆盖。

## 安装步骤
1. 备份电脑重要数据。用控制面板里的`备份和还原`，备份选项在控制面板里的`文件历史记录`。
2. 格出磁盘空间供ubuntu系统用：ubuntu系统可以识别windows系统的分区；但windows系统无法识别ubuntu系统的分区。所以在windows系统下，你会发现安装ubuntu系统的那个分区不见了。按住`win+x`，选择`磁盘管理`。选择剩余空间较大的可分配磁盘，右键选择`压缩卷`，输入压缩空间量大小为格出的空间。点击`压缩`后，会出现黑色的`未分配空间`。
3. 禁用快速启动（可选步骤）：按住`win+x`,选择`电源选项`，依次执行`选择电源按钮的功能`、`更改当前不可用的设置`、取消选择`启用快速启动`。快速启动会影响grub开机引导过程，可能出现无法载入ubuntu的状况。
4. 制作ubuntu的启动u盘：插入U盘，运行UltraISO, 点击`文件`, `打开`ubuntu的镜像文件。点击`启动`，选择`写入硬盘镜像`，按默认值写入。注意，写入过程中不要让你的电脑休眠，以免损坏U盘。写完后会有相应的成功提示。
5. 重启电脑，进入BIOS，关闭secure boot；找到Boot List Option,把它改为`UEFI`。然后设置启动顺序，把USB设置为首选启动项，这里一定要选名称中带UEFI的U盘选项，或者处于UEFI子栏的U盘项。然后重启电脑，进入ubuntu安装界面。
6. 根据安装引导界面进行设置，需注意的几点：
> `安装类型`界面：选择`其他选项`：为ubuntu创建分区。点击`创建新分区表`，点击`+`创建4个主要的基础分区。
> 点击`现在安装`之前，`安装启动引导器的设备`的参数选择：如果选择默认设备，ubuntu系统将成为主系统，ubuntu系统引导windows系统。如果选择`/boot`所在分区编号，windows系统将成为主系统，windows系统引导ubuntu系统。但安装成功后，再启动时，你发现还是没有启动ubuntu系统选项，还有最后一步。
7. 在windows系统中使用easyBCD设置启动引导项：选择`添加新条目`，选择`Linux/BCD操作系统`，在`驱动器`栏选择与`/boot`大小接近的Linux分区，点击添加条目。调整启动引导项的顺序，设置默认启动系统。
8. 重启进入grub引导界面，让你选择Windows boot management还是Ubuntu.

## Debugging:
将ubuntu系统设置为主系统怎么办？答案是删了重装！  
怎样删除ubuntu系统？  
1. 千万不要直接将ubuntu系统的分区格式化，否则很麻烦。
安装grub的时候，把硬盘的MBR修改了，但删除ubuntu的时候，却连原来的windows系统也启动不了。虽然可以通过系统盘、PE修复，但过于麻烦。
修复MBR的工具： MbrFix
2. 夺回系统引导权
恢复windows引导权：
> 下载MbrFix工具，放在C盘里；
> 以系统管理员身份运行cmd命令；
> 输入cmd命令：MBRFix/drive 0 fixmbr；
> 输入y；
> 重启。
你会发现，开机直接进入windows系统，可是无法进入ubuntu系统。
3. 格式化ubuntu系统分区；重新安装ubuntu系统。

如果你的电脑支持UEFI一定要用UEFI安装，一定不要使用EasyBCD从windows引导。
在安装步骤第6步，有博客说因为是UEFI安装，不需要建立`/boot`分区，而是建立`保留BIOS启动区域`，其他参数与`/boot`分区一样的设置。`安装启动引导器的设备`的参数为该分区。